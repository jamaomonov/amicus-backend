# –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Admin API

## –°–æ–∑–¥–∞–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏

–î–ª—è –º–æ–¥–µ–ª–µ–π **Category**, **Product** –∏ **File** –±—ã–ª —Å–æ–∑–¥–∞–Ω –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π CRUD API –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `admin/api/v1/`.

### –û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
admin/api/v1/
‚îú‚îÄ‚îÄ dependencies.py              # –û–±—â–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π
‚îú‚îÄ‚îÄ __init__.py                  # –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Ä–æ—É—Ç–µ—Ä, –æ–±—ä–µ–¥–∏–Ω—è—é—â–∏–π –≤—Å–µ –º–æ–¥—É–ª–∏
‚îú‚îÄ‚îÄ README.md                    # –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API
‚îÇ
‚îú‚îÄ‚îÄ categories/                  # –ú–æ–¥—É–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py             # –≠–∫—Å–ø–æ—Ä—Ç —Ä–æ—É—Ç–µ—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ schemas.py              # Pydantic —Å—Ö–µ–º—ã (CategoryCreate, CategoryUpdate, CategoryResponse)
‚îÇ   ‚îú‚îÄ‚îÄ crud.py                 # CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ (CategoryCRUD)
‚îÇ   ‚îî‚îÄ‚îÄ routes.py               # API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
‚îÇ
‚îú‚îÄ‚îÄ products/                    # –ú–æ–¥—É–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–¥—É–∫—Ç–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py             # –≠–∫—Å–ø–æ—Ä—Ç —Ä–æ—É—Ç–µ—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ schemas.py              # Pydantic —Å—Ö–µ–º—ã (ProductCreate, ProductUpdate, ProductResponse)
‚îÇ   ‚îú‚îÄ‚îÄ crud.py                 # CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ (ProductCRUD)
‚îÇ   ‚îî‚îÄ‚îÄ routes.py               # API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
‚îÇ
‚îî‚îÄ‚îÄ files/                       # –ú–æ–¥—É–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞–º–∏
    ‚îú‚îÄ‚îÄ __init__.py             # –≠–∫—Å–ø–æ—Ä—Ç —Ä–æ—É—Ç–µ—Ä–∞
    ‚îú‚îÄ‚îÄ schemas.py              # Pydantic —Å—Ö–µ–º—ã (FileCreate, FileUpdate, FileResponse)
    ‚îú‚îÄ‚îÄ crud.py                 # CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ (FileCRUD)
    ‚îî‚îÄ‚îÄ routes.py               # API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
```

## –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### –î–ª—è –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏ —Å–æ–∑–¥–∞–Ω—ã:

#### 1. **Schemas (Pydantic –º–æ–¥–µ–ª–∏)**
- `Base` - –±–∞–∑–æ–≤—ã–µ –ø–æ–ª—è –º–æ–¥–µ–ª–∏
- `Create` - —Å—Ö–µ–º–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è
- `Update` - —Å—Ö–µ–º–∞ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–≤—Å–µ –ø–æ–ª—è –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ)
- `Response` - —Å—Ö–µ–º–∞ –æ—Ç–≤–µ—Ç–∞ API
- `ListResponse` - —Å—Ö–µ–º–∞ –¥–ª—è —Å–ø–∏—Å–∫–æ–≤ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π

#### 2. **CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏**
- `create()` - —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏
- `get_by_id()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ ID
- `get_all()` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
- `update()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏
- `delete()` - —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏

#### 3. **API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã**
- `POST /` - —Å–æ–∑–¥–∞–Ω–∏–µ
- `GET /` - —Å–ø–∏—Å–æ–∫ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
- `GET /{id}` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ ID
- `PATCH /{id}` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
- `DELETE /{id}` - —É–¥–∞–ª–µ–Ω–∏–µ

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### üéØ –ß–∏—Å—Ç—ã–π –∫–æ–¥
- **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ —Å–ª–æ–∏**: routes ‚Üí crud ‚Üí models
- **Dependency Injection**: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ FastAPI dependencies
- **–¢–∏–ø–∏–∑–∞—Ü–∏—è**: –ø–æ–ª–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: docstrings –∏ –æ–ø–∏—Å–∞–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤

### üîÑ –ü–∞–≥–∏–Ω–∞—Ü–∏—è
–í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–æ–≤ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –ø–∞–≥–∏–Ω–∞—Ü–∏—é:
- `skip` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–ø—É—Å–∫–∞–µ–º—ã—Ö –∑–∞–ø–∏—Å–µ–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 0)
- `limit` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 100, –º–∞–∫—Å: 100)

### üîç –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è

**Products:**
- `category_id` - —Ñ–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- `is_active` - —Ñ–∏–ª—å—Ç—Ä –ø–æ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

**Files:**
- `product_id` - —Ñ–∏–ª—å—Ç—Ä –ø–æ –ø—Ä–æ–¥—É–∫—Ç—É

### ‚ö° –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å
–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º:
- `AsyncSession` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î
- `async/await` –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

### üõ°Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- HTTP 404 - –µ—Å–ª–∏ –∑–∞–ø–∏—Å—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
- HTTP 201 - —É—Å–ø–µ—à–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ
- HTTP 204 - —É—Å–ø–µ—à–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ
- –ü–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ

## URL —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤

–í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ –∞–¥—Ä–µ—Å—É: `http://localhost:8000/admin/api/v1/`

### Categories
- `POST /admin/api/v1/categories/`
- `GET /admin/api/v1/categories/`
- `GET /admin/api/v1/categories/{category_id}`
- `PATCH /admin/api/v1/categories/{category_id}`
- `DELETE /admin/api/v1/categories/{category_id}`

### Products
- `POST /admin/api/v1/products/`
- `GET /admin/api/v1/products/`
- `GET /admin/api/v1/products/{product_id}`
- `PATCH /admin/api/v1/products/{product_id}`
- `DELETE /admin/api/v1/products/{product_id}`

### Files
- `POST /admin/api/v1/files/`
- `GET /admin/api/v1/files/`
- `GET /admin/api/v1/files/{file_id}`
- `PATCH /admin/api/v1/files/{file_id}`
- `DELETE /admin/api/v1/files/{file_id}`

## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### 1. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞

```bash
cd /Users/macbook_uz/Projects/TipoProjects/amicus/backend
source venv/bin/activate
uvicorn main:app --reload
```

### 2. –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –æ—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä:
- **Swagger UI**: http://localhost:8000/admin/docs
- **ReDoc**: http://localhost:8000/admin/redoc

### 3. –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

#### –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
```bash
curl -X POST "http://localhost:8000/admin/api/v1/categories/" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞",
    "description": "–ö–∞—Ç–µ–≥–æ—Ä–∏—è —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤"
  }'
```

#### –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞
```bash
curl -X POST "http://localhost:8000/admin/api/v1/products/" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "–ù–æ—É—Ç–±—É–∫ Lenovo",
    "description": "–ú–æ—â–Ω—ã–π –Ω–æ—É—Ç–±—É–∫ –¥–ª—è —Ä–∞–±–æ—Ç—ã",
    "image": "/static/images/laptop.jpg",
    "is_active": true,
    "category_id": 1
  }'
```

#### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤
```bash
curl "http://localhost:8000/admin/api/v1/products/?skip=0&limit=10&category_id=1&is_active=true"
```

#### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞
```bash
curl -X PATCH "http://localhost:8000/admin/api/v1/products/1" \
  -H "Content-Type: application/json" \
  -d '{
    "is_active": false
  }'
```

#### –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
```bash
curl -X DELETE "http://localhost:8000/admin/api/v1/files/1"
```

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### 1. –û–±—â–∏–π dependencies.py
–í—Å–µ –º–æ–¥—É–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–±—â–∏–π —Ñ–∞–π–ª –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è DB —Å–µ—Å—Å–∏–∏:
```python
from admin.api.v1.dependencies import DBSession
```

### 2. CRUD –ø–∞—Ç—Ç–µ—Ä–Ω
–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ë–î –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ CRUD –∫–ª–∞—Å—Å—ã:
```python
category = await category_crud.create(session, category_in)
```

### 3. Pydantic –º–æ–¥–µ–ª–∏
–°—Ç—Ä–æ–≥–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –≤—Ö–æ–¥–µ –∏ –≤—ã—Ö–æ–¥–µ:
```python
class CategoryCreate(CategoryBase):
    pass

class CategoryUpdate(BaseModel):
    name: Optional[str] = None
    description: Optional[str] = None
```

### 4. –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ä–æ—É—Ç–µ—Ä–æ–≤
–í—Å–µ —Ä–æ—É—Ç–µ—Ä—ã —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ (`admin/api/v1/__init__.py`):
```python
router.include_router(categories_router)
router.include_router(products_router)
router.include_router(files_router)
```

## –°–≤—è–∑–∏ –º–µ–∂–¥—É –º–æ–¥–µ–ª—è–º–∏

```
Category (1) ‚îÄ‚îÄ‚îÄ (N) Product (1) ‚îÄ‚îÄ‚îÄ (N) File
```

- –û–¥–Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—è –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–Ω–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤
- –û–¥–∏–Ω –ø—Ä–æ–¥—É–∫—Ç –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–Ω–æ–≥–æ —Ñ–∞–π–ª–æ–≤
- –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É–¥–∞–ª—è—é—Ç—Å—è –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã (cascade)
- –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø—Ä–æ–¥—É–∫—Ç–∞ —É–¥–∞–ª—è—é—Ç—Å—è –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (cascade)

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä: `uvicorn main:app --reload`
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é: http://localhost:8000/admin/docs
3. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —á–µ—Ä–µ–∑ Swagger UI
4. ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)
5. ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å rate limiting (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)
6. ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)

## –ó–∞–º–µ—Ç–∫–∏

- –í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö PostgreSQL —á–µ—Ä–µ–∑ SQLAlchemy
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –¥—Ä–∞–π–≤–µ—Ä –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –°—Ö–µ–º—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è Pydantic
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ FastAPI
- –ö–æ–¥ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø–∞–º —á–∏—Å—Ç–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

